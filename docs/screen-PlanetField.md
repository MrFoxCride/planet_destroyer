# Screen – PlanetField

## 1. Description

Это основной экран игры, где игрок:
- свайпает планеты (влево — просмотр разрушенных, вправо — переход к новым),
- разрушает активную планету с помощью оружия,
- получает Cosmic Dust (частично сразу, остальное — через юниты),
- управляет основным циклом прогресса.

Экран по умолчанию отображается первым при запуске игры.

---

## 2. UX/Game Design

- Центр экрана — текущая планета
- Свайпы по экрану — переключение планет влево/вправо
- Планета может быть:
  - целая (можно атаковать)
  - разрушенная (можно отправить юниты)
  - собранная (удаляется)
- Снизу — фиксированная нижняя панель навигации (4 иконки)
- Взаимодействия: тап по кнопке атаки, отправка юнитов, сбор Dust

---

## 3. UI Elements

### 3.1. Planet Carousel Viewport
- Центр: 60% вертикали
- Один активный объект-планета
- Состояния:
  - целая: вращается медленно
  - разрушена: с трещинами / эффектом
- Swipe-логика:
  - Вправо: вперёд к новой планете
  - Влево: назад к предыдущим (пока не собраны)
- Один активный planetId

### 3.2. Attack Button
- Расположен под планетой, по центру
- Показывает текущее оружие и урон
- Нажатие:
  - Проверка: есть ли оружие
  - Отнимает HP у планеты
  - Запускает анимацию + расход 1 оружия
- Если оружия нет — кнопка заблокирована

### 3.3. Planet HP Bar
- Над планетой
- Показывает текущий HP
- Плавное уменьшение
- Визуальный эффект при получении урона
- Обнуление HP → планета разрушена

### 3.4. Instant Dust Popup
- Появляется при разрушении планеты
- `+XXX Cosmic Dust collected` (анимация, всплытие)
- Начисляется сразу на счёт

### 3.5. Dispatch Panel
- Показывается только при разрушенной планете
- Отображает 4 юнита:
  - Ship, Station, Robot, UFO
- У каждого — кнопка отправки, таймер, анимация
- При нажатии:
  - старт таймера
  - планета остаётся до завершения сбора

### 3.6. Planet Search Timer
- Если слот пуст (нет новой планеты)
- Текст: `Searching for planet... 03:42`
- Прогресс + обратный отсчёт
- Кнопка пропуска за Magmaton

### 3.7. Currency HUD
- Левый верхний угол
- Отображает:
  - Cosmic Dust (с иконкой)
  - Magmaton (с иконкой)
- Анимация при изменении значений (например, частицы)

### 3.8. Bottom Navigation Bar
- Закреплён внизу
- 4 иконки:
  - Arsenal, Upgrades, Dispatch, Wheel
- Подсветка активного экрана
- Навигация через FSM

### 3.9. Fake Leaderboard Button
- Правый верхний угол
- Маленькая иконка
- Подсвечивается при обгоне фейкового игрока
- Открывает `Leaderboard` экран

---

## 4. Entities & Logic

### 4.1. Planet Object Model
- `planetId`: string
- `hp`: number (max + current)
- `destroyedAt`: timestamp | null
- `harvested`: boolean
- `resourceProfile`: { baseYield, multiplier }

### 4.2. Weapon Sync
- Планета может быть атакована только если есть оружие в арсенале
- 1 оружие = 1 выстрел = фикс. урон

### 4.3. Swipe Logic
- Свайп → смена текущего `planetId`
- Влево: просмотр разрушенных (если не собраны)
- Вправо: новые планеты (если есть слот)
- Старые полностью собранные планеты исчезают

### 4.4. Harvest FSM
- После разрушения:
  - сразу начисляется часть Dust
  - остальное → через юнитов
- Планета удаляется после сбора всех ресурсов

---

## 5. Events (Triggers)

| Событие                 | Действие                                   |
|--------------------------|--------------------------------------------|
| `attackClick`            | Проверка оружия → урон → анимация         |
| `planetDestroyed`        | Popup Dust + показать Dispatch Panel      |
| `dispatchUnit`           | Старт таймера, юнит → планета             |
| `harvestComplete`        | Планета → удаляется                       |
| `swipeLeft/Right`        | Переключение `planetId`                   |
| `timerComplete`          | Новый слот → новая планета                |
| `navClick(screenName)`   | FSM → смена экрана                        |

---

## 6. Notes

- В этом экране сконцентрировано ~70% взаимодействия игрока
- Необходимо поддерживать масштабируемость: планеты, анимации, переходы
- Всё, что касается экономических действий, должно происходить здесь: атака, сбор, диспетч, расход оружия, накопление Dust