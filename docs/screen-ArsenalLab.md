# Screen – ArsenalLab

## 1. Description

Экран крафта оружия. Игрок тратит Cosmic Dust для создания атакующих единиц (оружий), которые затем используются на экране PlanetField.

Все оружия имеют стоимость, урон, время производства и лимит очереди. Игрок может ускорять создание за Magmaton.

---

## 2. UX/Game Design

- Вертикальный список всех типов оружий (по возрастанию силы)
- У каждого оружия:
  - иконка
  - название
  - урон
  - стоимость в Dust
  - время крафта
  - сколько уже есть на складе
- Над списком:
  - блок статуса очереди (например, 3/5 крафтов активны)
- В каждом слоте:
  - кнопка `Craft` (если есть ресурсы)
  - индикатор прогресса
  - кнопка `Finish Now` (за Magmaton)
- HUD валют сверху

---

## 3. UI Elements

### 3.1. Weapon Crafting Slot (1 на тип)
- Отображает:
  - Icon
  - Name
  - Damage
  - Cost (Dust)
  - Timer
  - Inventory Count
- Кнопка `Craft`:
  - Проверка на Dust
  - Запуск таймера
- Индикатор прогресса:
  - Показывает оставшееся время
- Кнопка `Finish Now`:
  - Показывается во время таймера
  - Отображает цену в Magmaton
  - Мигает, если почти завершено

### 3.2. Craft Queue Status
- Вверху экрана
- Показывает:
  - Сколько крафтов в очереди (например, 2/5)
  - Список всех активных крафтов с таймерами
  - Без интерактива

### 3.3. HUD (Dust / Magmaton)
- Левый верхний угол (общая шапка)
- Показывает:
  - Cosmic Dust
  - Magmaton
- Синхронизируется с глобальным ресурсом

### 3.4. Return to Planet Field Button
- Нижняя часть экрана
- Кнопка `Return to Field`
- Возвращает в `PlanetField` через FSM

---

## 4. Entities & Logic

### 4.1. Weapon Config Table
Каждое оружие содержит:
- `weaponId: string`
- `name: string`
- `baseDamage: number`
- `cost: number` (в Dust)
- `craftTime: number` (секунды)
- `visualFxId?: string`

Оружие определяется через external config (`weaponConfig.js`)

### 4.2. Crafting Queue
- Одновременных слотов: 2–5 (по апгрейду)
- Craft:
  - запускается в очередь
  - продолжает работать в фоне
  - завершённые → попадают в инвентарь
- Таймеры:
  - считают онлайн и оффлайн (через timestamps)

### 4.3. Weapon Inventory
- Инвентарь по каждому weaponId
- Используется на PlanetField
- FIFO — первым скрафтированным — первым используется

---

## 5. Events (Triggers)

| Событие            | Действие                                       |
|---------------------|------------------------------------------------|
| `craftClick(weaponId)` | Проверка Dust → старт крафта                 |
| `craftTimerComplete`   | +1 в инвентарь, убирается из очереди         |
| `finishNowClick`       | Проверка Magmaton → немедленное завершение   |
| `returnClick`          | FSM → переход на `PlanetField`              |

---

## 6. Notes

- Экран не может быть открыт, если нет места в очереди (опциональное правило)
- Craft работает даже если игрок не на экране
- Все операции должны учитывать сохранение и восстановление после перезапуска
- Этот экран — источник атакующего ресурса, без которого основной loop невозможен